<!DOCTYPE html>
<html>
<head>
  <title>음악 리믹스</title>
  <style>
    .slider {
      width: 200px;
      margin-bottom: 10px;
    }
    
    #danceMoves {
    position: relative; /* 부모 요소를 상대 위치로 설정 */
    width: 200px;
    height: 200px;
    transform: translate(100%, 100%);
  }

  #leftImage,
  #rightImage {
    width: 100px;
    height: auto;
    z-index: 3;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(100%, 100%);
  }

     #leftImage,
  #rightImage {
    width: 100px;
    height: auto;
    z-index: 3;
    position: absolute;
    top: 50%;
    left: calc(50% + 20px); /* 수정된 부분 */
    transform: translate(-50%, -50%);
  }

    
    .left {
      transform: scaleX(-1);
    }

    .letter {
      position: relative;
    
      font-family: 'Rubik Puddles', sans-serif;

      font-size: 20px;
      font-weight: lighter;
      color: royalblue;
      text-align: left;
    
      z-index: 0;
      
      line-height: 0.9;
    }
  </style>
</head>
<body>
  
  <div class="letter">
    <h1>press left or right or up key<br></h1>
  </div>

  <label for="audio1">음악 1:</label>
  <input type="range" class="slider" id="volume1" min="0" max="1" step="0.1" value="1">
  <br>

  <label for="audio2">음악 2:</label>
  <input type="range" class="slider" id="volume2" min="0" max="1" step="0.1" value="1">
  <br>

  <label for="audio3">음악 3:</label>
  <input type="range" class="slider" id="volume3" min="0" max="1" step="0.1" value="1">
  <br>

  <div id="danceMoves">
    <img id="leftImage" class="danceImage" src="images/left.png" alt="왼쪽 춤추는 사람">
    <img id="rightImage" class="danceImage" src="images/right.png" alt="오른쪽 춤추는 사람">
  </div>

  <script>
    // 슬라이더 요소 가져오기
    var volumeSlider1 = document.getElementById("volume1");
    var volumeSlider2 = document.getElementById("volume2");
    var volumeSlider3 = document.getElementById("volume3");

    // 오디오 요소 가져오기
    var audio1 = new Audio("Happy Cat.mp3");
    var audio2 = new Audio("maxwell.mp3");
    var audio3 = new Audio("capi.mp3");

    // 초기화 후 음악 반복 재생
    audio1.addEventListener("canplaythrough", function() {
      audio1.loop = true;
    });

    audio2.addEventListener("canplaythrough", function() {
      audio2.loop = true;
    });

    audio3.addEventListener("canplaythrough", function() {
      audio3.loop = true;
    });

    // 슬라이더 이벤트 핸들러 등록
    volumeSlider1.addEventListener("input", function() {
      audio1.volume = volumeSlider1.value;
    });

    volumeSlider2.addEventListener("input", function() {
      audio2.volume = volumeSlider2.value;
    });

    volumeSlider3.addEventListener("input", function() {
      audio3.volume = volumeSlider3.value;
    });

    // 춤을 추는 모션
    var danceMoves = document.getElementById("danceMoves");
    var leftImage = document.getElementById("leftImage");
    var rightImage = document.getElementById("rightImage");
    var isLeftMove = true;
    var isJumping = false;
    var originalTop = danceMoves.offsetHeight / 2;

    function jump(image) {
      if (isJumping) return;

      isJumping = true;
      var jumpHeight = 100; // 점프 높이 (픽셀 단위)
      var jumpDuration = 500; // 점프 지속 시간 (밀리초 단위)

      var startTime = Date.now();

      function animateJump() {
        var elapsedTime = Date.now() - startTime;
        var progress = elapsedTime / jumpDuration;

        if (progress >= 1) {
          // 점프 완료 후 원래 자리로 돌아오기
          image.style.top = originalTop + "px";
          isJumping = false;
          return;
        }

        // 점프 중인 경우 이미지를 위로 이동시키기
        var jumpStep = Math.sin(progress * Math.PI) * jumpHeight;
        image.style.top = originalTop - jumpStep + "px";

        requestAnimationFrame(animateJump);
      }

      animateJump();
    }

    function toggleDanceMove() {
      if (isLeftMove) {
        leftImage.style.display = "none";
        rightImage.style.display = "block";
      } else {
        leftImage.style.display = "block";
        rightImage.style.display = "none";
      }

      isLeftMove = !isLeftMove;
    }

    leftImage.style.display = "none";

    document.addEventListener("keydown", function(event) {
      if (event.key === "ArrowLeft") {
        toggleDanceMove();
      } else if (event.key === "ArrowRight") {
        toggleDanceMove();
      } else if (event.key === "ArrowUp") {
        if (isLeftMove) {
          jump(leftImage);
        } else {
          jump(rightImage);
        }
      }

      // 아무 키보드를 누르면 모든 음악 재생
      audio1.play();
      audio2.play();
      audio3.play();
    });
  </script>
</body>
</html>
